<!DOCTYPE html>
<html lang="en" >
  <head>
  <script src="https://cdn.firebase.com/js/client/2.2.9/firebase.js"></script>
  <!--<script>var Firebase = require("firebase");</script>-->
    <meta charset="utf-8" />
    <meta name="author" content="Script Tutorials" />
    <title>Study With Me | My Profile</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="shortcut icon" href="images/people.png" type="image">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <link href='https://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>
    <!-- attach CSS styles -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/profile.css" rel="stylesheet" />

       <!-- liveReload - So developers dont have to hit the refresh button. Delete in production version -->
  <!--<script>document.write('<script src="http://' + (location.host || 'localhost').split(':')[0] + ':35729/livereload.js?snipver=1"></' + 'script>')</script>-->
  </head>

  <body>
    <!-- navigation panel -->
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
      <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse-main">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="profile.html">Welcome, <span class="fname">User</span>!</a>
        </div>

        <div class="collapse navbar-collapse" id="navbar-collapse-main">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="profile.html">My Profile</a></li>
            <li><a href="settings.html">Settings</a></li>
            <li><a href="index.html" onclick="disconnect()">Sign Out</a></li>
          </ul>
        </div><!-- /.navbar-collapse -->
      </div><!-- /.container-fluid -->
    </nav>

    <!-- first section - Home -->
    <div id="home" class="home">


    <br>
    <br>
    <br>
       <div class="text-vcenter">
        <div class="signin-card">
          <div class="row">
            <div class="col-m-3">
              <i id="userImg" class="fa fa-user"></i>
            </div>
            <div class="col-sm-4">
              <p class="name"><span class="fname"></span> <span class="lname"></span></p>
              <p class="info">Florida State University</p>
              
              
            </div>
          </div>
          <hr>
          <div class="row">
            <div class="col-md-8">
              &nbsp;
            </div>
            <div class="col-md-4">
              <div id="chatterBox" class="panel-body">
                <div class="panel panel-default">
                    <div class="panel-heading">
                      <h2 class="panel-title">Chat Box</h2>
                    </div>
                    <div id="chatterBox" class="panel-body">
                      <div id="chatter"></div>
                      <input class="form-control" type='text' id='messageInput' placeholder='Message'>
                    </div>
                </div>
                <div id="chatter"></div>
              </div>
            </div>
          </div>
            <br>
            <br>
            <br>
            <br>
        </div>
        <br>
        <br>
        <br> 
      </div>
    </div>


    </div>
    <!-- /first section -->

    <!-- footer -->
    <footer>
      <div class="text-vcenter">
      <div class="container">
        <a href="userContactUs.html" class="blueLink">Contact Us</a>
        <p class="text-center">Copyright &copy; Study With Me | 2015</p>
      </div>
      </div>
    </footer>
    <!-- /footer -->

    <!-- attach JavaScripts -->
    <script src="js/jquery-1.10.2.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/jquery.scrollTo.min.js"></script>
    <script type="text/javascript" src="js/jquery.localScroll.min.js"></script>
    <script>



      $(function(){
        $("#chatter").load("includes/chatterbox.html"); 
      });
      //$snapshot.val().firstname
      function isUserLoggedIn(authData) {
      //Previously called authDataCallback by Firebase Docs https://www.firebase.com/docs/web/guide/user-auth.html
      if (authData) {
        //console.log('AUTH-ED', "https://vivid-torch-1590.firebaseio.com/users/" + authData.uid, authData);
        // console.log("User " + authData.uid + " is logged in with " + authData.provider);

        var profileRef = new Firebase("https://vivid-torch-1590.firebaseio.com/users/" + authData.uid);
        profileRef.once('value', function(snapshot) {
          console.log('|||=====', snapshot.val().firstname);
          $(".fname").text(snapshot.val().firstname);
          $(".lname").text(snapshot.val().lastname);
        });

        

        // console.log(dump(authData));
      } else {
        console.log("User is logged out");
      }
    }
    var ref = new Firebase("https://vivid-torch-1590.firebaseio.com");
    ref.onAuth(isUserLoggedIn);

    function disconnect(){
      ref.unauth();
    }

    /* repeatString() returns a string which has been repeated a set number of times */ 
  function repeatString(str, num) {
      out = '';
      for (var i = 0; i < num; i++) {
          out += str; 
      }
      return out;
  }

  /*
  dump() displays the contents of a variable like var_dump() does in PHP. dump() is
  better than typeof, because it can distinguish between array, null and object.  
  Parameters:
    v:              The variable
    howDisplay:     "none", "body", "alert" (default)
    recursionLevel: Number of times the function has recursed when entering nested
                    objects or arrays. Each level of recursion adds extra space to the 
                    output to indicate level. Set to 0 by default.
  Return Value:
    A string of the variable's contents 
  Limitations:
    Can't pass an undefined variable to dump(). 
    dump() can't distinguish between int and float.
    dump() can't tell the original variable type of a member variable of an object.
    These limitations can't be fixed because these are *features* of JS. However, dump()
  */
  function dump(v, howDisplay, recursionLevel) {
      howDisplay = (typeof howDisplay === 'undefined') ? "alert" : howDisplay;
      recursionLevel = (typeof recursionLevel !== 'number') ? 0 : recursionLevel;


      var vType = typeof v;
      var out = vType;

      switch (vType) {
          case "number":
              /* there is absolutely no way in JS to distinguish 2 from 2.0
              so 'number' is the best that you can do. The following doesn't work:
              var er = /^[0-9]+$/;
              if (!isNaN(v) && v % 1 === 0 && er.test(3.0))
                  out = 'int';*/
          case "boolean":
              out += ": " + v;
              break;
          case "string":
              out += "(" + v.length + '): "' + v + '"';
              break;
          case "object":
              //check if null
              if (v === null) {
                  out = "null";

              }
              //If using jQuery: if ($.isArray(v))
              //If using IE: if (isArray(v))
              //this should work for all browsers according to the ECMAScript standard:
              else if (Object.prototype.toString.call(v) === '[object Array]') {  
                  out = 'array(' + v.length + '): {\n';
                  for (var i = 0; i < v.length; i++) {
                      out += repeatString('   ', recursionLevel) + "   [" + i + "]:  " + 
                          dump(v[i], "none", recursionLevel + 1) + "\n";
                  }
                  out += repeatString('   ', recursionLevel) + "}";
              }
              else { //if object    
                  sContents = "{\n";
                  cnt = 0;
                  for (var member in v) {
                      //No way to know the original data type of member, since JS
                      //always converts it to a string and no other way to parse objects.
                      sContents += repeatString('   ', recursionLevel) + "   " + member +
                          ":  " + dump(v[member], "none", recursionLevel + 1) + "\n";
                      cnt++;
                  }
                  sContents += repeatString('   ', recursionLevel) + "}";
                  out += "(" + cnt + "): " + sContents;
              }
              break;
      }

      if (howDisplay == 'body') {
          var pre = document.createElement('pre');
          pre.innerHTML = out;
          document.body.appendChild(pre)
      }
      else if (howDisplay == 'alert') {
          alert(out);
      }

      return out;
  }
    </script>
  </body>

</html>


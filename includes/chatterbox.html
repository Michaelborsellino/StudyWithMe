<!-- Include this file on any page you wish to see a chatter box.-->
<script>
var myDataRef = new Firebase('https://vivid-torch-1590.firebaseIO.com/');

myDataRef.on('child_added', function(snapshot) {
        var message = snapshot.val();
        displayChatMessage(message.name, message.text);
        
        /*
        //Popup notifications
        var notification;
		      notification = new Notification(message.name, {
		        tag: $("#hiddenNotificationTag").val(),
		        body: message.text,
		        iconUrl: $("#hiddenNotificationIcon").val(),
		        icon: $("#hiddenNotificationIcon").val()
		      });
		      return notification.onclick = function() {
		        notification.close();
		        window.open().close();
		        return window.focus();
		      };
		      */
      });
 function displayChatMessage(from, body) {
        $('<div/>').text(text).prepend($('<em/>').text(name+': ')).appendTo($('#chatter'));
        $('#chatterBox')[0].scrollTop = $('#chatterBox')[0].scrollHeight;
      };

$(document).ready(function(){
    $('#chatterBox').animate({
        scrollTop: $('#chatterBox')[0].scrollHeight}, 2000);
});
$('#messageInput').keypress(function (e) {
  		if (e.keyCode == 13 ) { //enter key
  			myDataRef.once('value', function(snapshot) {
  				var name = snapshot.val().firstname;
  			})
          	var text = $('#messageInput').val();

          	//myDataRef.set('User ' + name + ' says ' + text);
          	myDataRef.push({name: name, text: text});

  			$('#messageInput').val('');

  			
  		}
});



</script>